{"version":3,"sources":["../../src/components/Slider.js"],"names":["sliderStyle","display","paddingBottom","zIndex","marginLeft","handleStyle","cursor","Slider","window","addEventListener","mouseMove","bind","dragEnd","removeEventListener","state","dragging","index","e","stopPropagation","setState","dragIndex","props","dragChange","x","nativeEvent","layerX","touches","pageX","$","width","selection","selected","scale","invert","Math","abs","onChange","selectionWidth","f","selectionFormat","height","dragFromSVG","reset","selectionColor","selectionSorted","map","m","i","dragStart","sliderPrefix","propTypes","data","arrayOf","number","isRequired","start","end","padding","bucketSize","string","histogramPadding","func"],"mappings":"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","file":"Slider.js","sourcesContent":["  import React, { Component, PropTypes } from 'react'\n  import { format } from 'd3-format'\n\nconst sliderStyle = {\n  display: 'block',\n  paddingBottom: '8px',\n  zIndex: '2',\n  marginLeft: '5%',\n}\n\nconst handleStyle = {\n  cursor: 'move'\n}\n\nexport default class Slider extends Component {\n\n  componentDidMount () {\n    window.addEventListener('mousemove', this.mouseMove.bind(this), false)\n    window.addEventListener('mouseup', this.dragEnd.bind(this), false)\n    window.addEventListener('touchmove', this.mouseMove.bind(this), false)\n    window.addEventListener('touchend', this.dragEnd.bind(this), false)\n  }\n\n  componentWilUnmount () {\n    window.removeEventListener('mousemove', this.mouseMove.bind(this), false)\n    window.removeEventListener('mouseup', this.dragEnd.bind(this), false)\n    window.removeEventListener('touchmove', this.mouseMove.bind(this), false)\n    window.removeEventListener('touchend', this.dragEnd.bind(this), false)\n  }\n\n  constructor () {\n    super()\n    this.state = {\n      dragging: false\n    }\n  }\n\n  dragStart (index, e) {\n    e.stopPropagation()\n    if (!this.state.dragging) {\n      this.setState({\n        dragging: true,\n        dragIndex: index\n      }, () => {\n        this.props.dragChange(true)\n      })\n    }\n  }\n\n  dragEnd (e) {\n    e.stopPropagation()\n    this.setState({\n      dragging: false\n    }, () => {\n      this.props.dragChange(false)\n    })\n  }\n\n  dragFromSVG (e) {\n    if (!this.state.dragging) {\n      const x = (e.nativeEvent.layerX || e.nativeEvent.touches[0].pageX) / $('.Histoslider').width() * 100;\n      let selection = [...this.props.selection]\n      let selected = this.props.scale.invert(x)\n      let dragIndex\n\n      if (Math.abs(selected - selection[0]) > Math.abs(selected - selection[1])) {\n        selection[1] = selected\n        dragIndex = 0\n      } else {\n        selection[0] = selected\n        dragIndex = 1\n      }\n\n      this.props.onChange(selection)\n      this.setState({\n        dragging: true,\n        dragIndex\n      }, () => {\n        this.props.dragChange(true)\n      })\n    }\n  }\n\n  mouseMove (e) {\n    if (this.state.dragging) {\n      let selection = [...this.props.selection]\n      selection[this.state.dragIndex] = this.props.scale.invert((e.layerX || e.touches[0].pageX) / $('.Histoslider').width() * 100);\n      this.props.onChange(selection)\n    }\n  }\n\n  render () {\n    const selection = this.props.selection\n    const selectionWidth = Math.abs(this.props.scale(selection[1]) - this.props.scale(selection[0]))\n    const f = format(this.props.selectionFormat);\n\n    return (\n      <svg\n        style={sliderStyle}\n        height={this.props.height - 10}\n        x='5%'\n        width={'90%'}\n        onMouseDown={this.dragFromSVG.bind(this)}\n        onTouchStart={this.dragFromSVG.bind(this)}\n        onDoubleClick={this.props.reset}\n      >\n        <rect\n          height={4}\n          fill={'#f1f1f1'}\n          x={'0%'}\n          y={10}\n          width={'100%'}\n        />\n        <rect\n          height={4}\n          fill={this.props.selectionColor}\n          x={this.props.scale(this.props.selectionSorted[0]) + '%'}\n          y={10}\n          width={selectionWidth + '%'}\n        />\n        {\n          this.props.selection.map((m, i) => {\n            return (\n              <svg x={this.props.scale(m) + '%'}>\n              <g transform={'translate(0, 0)'} key={i}>\n                <circle\n                  style={handleStyle}\n                  r={10}\n                  cx={0}\n                  cy={12.5}\n                  fill='#ddd'\n                  strokeWidth='1'\n                />\n                <circle\n                  style={handleStyle}\n                  onMouseDown={this.dragStart.bind(this, i)}\n                  onTouchStart={this.dragStart.bind(this, i)}\n                  r={9}\n                  cx={0}\n                  cy={12}\n                  fill='white'\n                  stroke='#ccc'\n                  strokeWidth='1'\n                />\n                <text\n                  textAnchor='middle'\n                  x={0}\n                  y={36}\n                  fill='#666'\n                  fontSize={12}\n                >\n                  {this.props.sliderPrefix + f(m)}\n                </text>\n              </g>\n              </svg>\n            )\n          })\n        }\n      </svg>\n    )\n  }\n}\n\nSlider.propTypes = {\n  data: PropTypes.arrayOf(PropTypes.number).isRequired,\n  selection: PropTypes.arrayOf(PropTypes.number).isRequired,\n  selectionSorted: PropTypes.arrayOf(PropTypes.number).isRequired,\n  start: PropTypes.number,\n  end: PropTypes.number,\n  height: PropTypes.number,\n  padding: PropTypes.number,\n  bucketSize: PropTypes.number,\n  selectionColor: PropTypes.string,\n  histogramPadding: PropTypes.number,\n  scale: PropTypes.func,\n  reset: PropTypes.func,\n  dragChange: PropTypes.func,\n  onChange: PropTypes.func,\n  selectionFormat: PropTypes.string,\n  sliderPrefix: PropTypes.string,\n}\n"]}